<mix-dialog-wrapper [titleTpl]="titleTpl">
  <div dialog-body [formGroup]="form">
    @if (showAlterColumnWarning()) {
      <div class="text-center">Your column has been created successfully!</div>

      <div class="mt-4 text-center">
        Do you want to reflect change immediately to your table ?
      </div>
    } @else {
      <mix-form-field
        class="w-full"
        [required]="true"
        [autoFocus]="true"
        [name]="'common.label.displayName'"
      >
        <input
          #autofocus
          formControlName="displayName"
          class="input input-bordered"
          [placeholder]="'common.input.placeholder' | transloco"
        />
      </mix-form-field>

      <mix-form-field
        class="w-full mt-6"
        [required]="true"
        [name]="'database.column.systemNameLabel'"
        [description]="'database.column.systemNameGuide'"
      >
        <input
          formControlName="systemName"
          class="input input-bordered"
          [placeholder]="'common.input.placeholder' | transloco"
        />
      </mix-form-field>

      <mix-form-field
        class="w-full mt-5"
        [name]="'database.column.defaultValueLabel'"
      >
        <div class="w-full relative">
          <textarea
            formControlName="defaultValue"
            class="textarea textarea-bordered"
            [placeholder]="'common.input.placeholder' | transloco"
            rows="5"
          ></textarea>

          <div class="flex items-center text-sm absolute bottom-2 right-2">
            0/50
            <div
              class="divider divider-horizontal !h-[12px] !mx-2 !px-2 !self-center"
            ></div>
            <label class="label">
              <input
                type="checkbox"
                checked="checked"
                class="checkbox checkbox-sm checkbox-primary"
              />
              null
            </label>
          </div>
        </div>
      </mix-form-field>

      <div class="configuration mt-6" [formGroup]="configurationForms">
        <mix-toggle
          formControlName="isRequire"
          class="block"
          [description]="'Mark this is a require attribute'"
        >
          Required
        </mix-toggle>

        <mix-toggle
          formControlName="isUnique"
          class="block mt-4"
          [description]="'Mark this attribute as unique in the system'"
        >
          Unique
        </mix-toggle>
      </div>
    }
  </div>

  <div dialog-footer class="flex items-center justify-end gap-4">
    @if (showAlterColumnWarning()) {
      <mix-button type="ghost" (click)="dialogRef.close()">{{
        'Skip & Continue' | transloco
      }}</mix-button>

      <mix-button
        color="primary"
        (click)="onReflectChange()"
        [loading]="isLoading()"
        >{{ 'Reflect change' | transloco }}</mix-button
      >
    } @else {
      <mix-button type="ghost" (click)="dialogRef.close()">{{
        'common.cancel' | transloco
      }}</mix-button>

      <mix-button
        color="primary"
        (click)="onSubmit()"
        [loading]="isLoading()"
        >{{ 'common.create' | transloco }}</mix-button
      >
    }
  </div>
</mix-dialog-wrapper>

<ng-template #titleTpl>
  <span class="text-2xl font-title !font-medium flex items-center gap-4">
    <div
      class="w-8 h-8 rounded-xl flex items-center justify-center text-white"
      [style.background]="dataTypeDisplay.color"
    >
      <mix-icon [icon]="dataTypeDisplay.icon"></mix-icon>
    </div>

    @let name = `database.${dataTypeDisplay.displayName}`;
    {{ name | transloco }}
  </span>
</ng-template>
