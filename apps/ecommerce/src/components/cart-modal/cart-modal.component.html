<div class="p-4 md:p-8 bg-base-100 w-full] pt-6 md:pt-8">
  @if (isAddNew) {
    <div
      class="rounded-lg px-4 py-2 bg-success/20 mb-8 flex items-center gap-4"
    >
      Thêm vào giỏ hàng thành công
    </div>
  }

  <div class="text-lg md:text-xl mb-8 font-medium">Giỏ hàng</div>

  <ul
    role="list"
    class="-my-6 divide-y divide-gray-200 max-h-[50vh] overflow-auto"
  >
    @for (item of cartStore.items(); track item.id) {
      <li class="flex py-6">
        <div
          class="size-24 shrink-0 overflow-hidden rounded-md border border-gray-200"
        >
          <img alt="" [src]="item.thumbnail" class="size-full object-contain" />
        </div>

        <div class="ml-4 flex flex-1 flex-col">
          <div>
            <div
              class="flex justify-between text-base font-medium text-gray-900"
            >
              <div>
                <div class="text-base">{{ item.title }}</div>
                @if (item.systemNote) {
                  <div class="text-sm text-base-content/60">
                    {{ item.systemNote }}
                  </div>
                }
              </div>
              <p class="ml-4 font-semibold">
                <app-currency
                  [value]="item.price"
                  [currency]="'đ'"
                ></app-currency>
                x
                {{ item.quantity }}
              </p>
            </div>
          </div>
          <div class="flex flex-1 items-end mt-12 justify-between text-sm">
            <div class="flex items-center gap-4 ms-auto">
              <div class="join join-horizontal">
                <button
                  class="btn join-item btn-square btn-outline btn-sm md:btn-base"
                  (click)="decrease(item.id, item.quantity)"
                >
                  -
                </button>
                <button class="btn join-item btn-outline btn-sm md:btn-base">
                  {{ item.quantity }}
                </button>
                <button
                  class="btn join-item btn-square btn-outline btn-sm md:btn-base"
                  (click)="increase(item.id, item.quantity)"
                >
                  +
                </button>
              </div>

              <button
                (click)="onRemove(item.id)"
                type="button"
                class="btn btn-error text-white btn-sm md:btn-base"
              >
                Xóa
              </button>
            </div>
          </div>
        </div>
      </li>
    } @empty {
      <li class="flex py-6">
        <div class="flex-1 text-center text-gray-500">
          Giỏ hàng của bạn hiện đang trống, tiếp tục mua sắm
        </div>
      </li>
    }
  </ul>

  <div class="w-full py-4 mt-8 border-t border-b border-base-content/10">
    <div class="flex items-center justify-between">
      <p class="font-medium text-gray-900 md:text-xl">Tạm tính:</p>
      <p class="font-bold text-gray-900 md:text-xl">
        <app-currency [value]="cartStore.totalPrice()"></app-currency>
      </p>
    </div>
  </div>

  <div class="mt-6 flex items-center justify-between">
    <button class="btn btn-outline" (click)="ref.close()">
      Tiếp tục mua sắm
    </button>
    <button
      class="btn btn-primary"
      (click)="router.navigateByUrl('/checkout'); ref.close()"
    >
      Thanh toán
    </button>
  </div>
</div>
